[0m[1maws_iam_policy.transcribe-lambda-policy: Refreshing state... [id=arn:aws:iam::166366443471:policy/transcribe-lambda-policy][0m
[0m[1maws_api_gateway_rest_api.transcriber-api-gateway: Refreshing state... [id=x0pu13lwle][0m
[0m[1maws_iam_role.transcribe-lambda-role: Refreshing state... [id=transcribe-lambda-role][0m
[0m[1maws_s3_bucket.transcriber-deployment-package-bucket-715: Refreshing state... [id=transcriber-deployment-package-bucket-715][0m
[0m[1maws_s3_bucket.audio-bucket-715: Refreshing state... [id=audio-bucket-715][0m
[0m[1maws_api_gateway_resource.transcriber-api-gateway-resource: Refreshing state... [id=twufwu][0m
[0m[1maws_api_gateway_method.transcriber-api-method-option: Refreshing state... [id=agm-x0pu13lwle-twufwu-OPTIONS][0m
[0m[1maws_api_gateway_method.transcriber-api-method-post: Refreshing state... [id=agm-x0pu13lwle-twufwu-POST][0m
[0m[1maws_api_gateway_integration.transcriber-api-integration-option: Refreshing state... [id=agi-x0pu13lwle-twufwu-OPTIONS][0m
[0m[1maws_api_gateway_method_response.transcriber-api-method-response-option: Refreshing state... [id=agmr-x0pu13lwle-twufwu-OPTIONS-200][0m
[0m[1maws_api_gateway_method_response.transcriber-api-method-response-post: Refreshing state... [id=agmr-x0pu13lwle-twufwu-POST-200][0m
[0m[1maws_api_gateway_integration_response.transcriber-api-integration-response-option: Refreshing state... [id=agir-x0pu13lwle-twufwu-OPTIONS-200][0m
[0m[1maws_iam_role_policy_attachment.attach-iam-policy-to-transcribe-lambda-role: Refreshing state... [id=transcribe-lambda-role-20240721233711311200000001][0m
[0m[1maws_s3_bucket_versioning.audio-bucket-715-versioning: Refreshing state... [id=audio-bucket-715][0m
[0m[1maws_s3_bucket_versioning.transcriber-deployment-package-bucket-715-versioning: Refreshing state... [id=transcriber-deployment-package-bucket-715][0m
[0m[1maws_s3_object.transcribe-lambda-zip: Refreshing state... [id=lambda.zip][0m
[0m[1maws_s3_object.audio-downloader-lambda-zip: Refreshing state... [id=audio_downloader_lambda.zip][0m

[1m[36mNote:[0m[1m Objects have changed outside of Terraform
[0m
Terraform detected the following changes made outside of Terraform since the
last "terraform apply" which may have affected this plan:

[1m  # aws_s3_object.audio-downloader-lambda-zip[0m has changed
[0m  [33m~[0m[0m resource "aws_s3_object" "audio-downloader-lambda-zip" {
        id                     = "audio_downloader_lambda.zip"
      [32m+[0m[0m version_id             = "vyqUqmfibe4_WYoW42h_oqVfWyD88Qcx"
        [90m# (10 unchanged attributes hidden)[0m[0m
    }

[1m  # aws_s3_object.transcribe-lambda-zip[0m has changed
[0m  [33m~[0m[0m resource "aws_s3_object" "transcribe-lambda-zip" {
        id                     = "lambda.zip"
      [32m+[0m[0m version_id             = "Fby6.WXUrkl9No.N9VVbnpkq6WLG2q86"
        [90m# (10 unchanged attributes hidden)[0m[0m
    }


Unless you have made equivalent changes to your configuration, or ignored the
relevant attributes using ignore_changes, the following plan may include
actions to undo or respond to these changes.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_api_gateway_deployment.transcriber_api_deployment[0m will be created
[0m  [32m+[0m[0m resource "aws_api_gateway_deployment" "transcriber_api_deployment" {
      [32m+[0m[0m created_date  = (known after apply)
      [32m+[0m[0m execution_arn = (known after apply)
      [32m+[0m[0m id            = (known after apply)
      [32m+[0m[0m invoke_url    = (known after apply)
      [32m+[0m[0m rest_api_id   = "x0pu13lwle"
    }

[1m  # aws_api_gateway_integration.transcriber-api-integration-post[0m will be created
[0m  [32m+[0m[0m resource "aws_api_gateway_integration" "transcriber-api-integration-post" {
      [32m+[0m[0m cache_namespace         = (known after apply)
      [32m+[0m[0m connection_type         = "INTERNET"
      [32m+[0m[0m content_handling        = "CONVERT_TO_TEXT"
      [32m+[0m[0m http_method             = "POST"
      [32m+[0m[0m id                      = (known after apply)
      [32m+[0m[0m integration_http_method = "POST"
      [32m+[0m[0m passthrough_behavior    = "WHEN_NO_MATCH"
      [32m+[0m[0m resource_id             = "twufwu"
      [32m+[0m[0m rest_api_id             = "x0pu13lwle"
      [32m+[0m[0m timeout_milliseconds    = 29000
      [32m+[0m[0m type                    = "AWS_PROXY"
      [32m+[0m[0m uri                     = (known after apply)
    }

[1m  # aws_api_gateway_integration_response.transcriber-api-integration-response-post[0m will be created
[0m  [32m+[0m[0m resource "aws_api_gateway_integration_response" "transcriber-api-integration-response-post" {
      [32m+[0m[0m http_method = "POST"
      [32m+[0m[0m id          = (known after apply)
      [32m+[0m[0m resource_id = "twufwu"
      [32m+[0m[0m rest_api_id = "x0pu13lwle"
      [32m+[0m[0m status_code = "200"
    }

[1m  # aws_api_gateway_stage.transcriber-api-dev[0m will be created
[0m  [32m+[0m[0m resource "aws_api_gateway_stage" "transcriber-api-dev" {
      [32m+[0m[0m arn           = (known after apply)
      [32m+[0m[0m deployment_id = (known after apply)
      [32m+[0m[0m execution_arn = (known after apply)
      [32m+[0m[0m id            = (known after apply)
      [32m+[0m[0m invoke_url    = (known after apply)
      [32m+[0m[0m rest_api_id   = "x0pu13lwle"
      [32m+[0m[0m stage_name    = "dev"
      [32m+[0m[0m tags_all      = (known after apply)
      [32m+[0m[0m web_acl_arn   = (known after apply)
    }

[1m  # aws_lambda_function.download-audio-function-715[0m will be created
[0m  [32m+[0m[0m resource "aws_lambda_function" "download-audio-function-715" {
      [32m+[0m[0m architectures                  = (known after apply)
      [32m+[0m[0m arn                            = (known after apply)
      [32m+[0m[0m code_sha256                    = (known after apply)
      [32m+[0m[0m function_name                  = "download-audio-function-715"
      [32m+[0m[0m handler                        = "main.lambda_handler"
      [32m+[0m[0m id                             = (known after apply)
      [32m+[0m[0m invoke_arn                     = (known after apply)
      [32m+[0m[0m last_modified                  = (known after apply)
      [32m+[0m[0m memory_size                    = 1000
      [32m+[0m[0m package_type                   = "Zip"
      [32m+[0m[0m publish                        = false
      [32m+[0m[0m qualified_arn                  = (known after apply)
      [32m+[0m[0m qualified_invoke_arn           = (known after apply)
      [32m+[0m[0m reserved_concurrent_executions = -1
      [32m+[0m[0m role                           = "arn:aws:iam::166366443471:role/transcribe-lambda-role"
      [32m+[0m[0m runtime                        = "python3.10"
      [32m+[0m[0m s3_bucket                      = "transcriber-deployment-package-bucket-715"
      [32m+[0m[0m s3_key                         = "audio_downloader_lambda.zip"
      [32m+[0m[0m s3_object_version              = "vyqUqmfibe4_WYoW42h_oqVfWyD88Qcx"
      [32m+[0m[0m signing_job_arn                = (known after apply)
      [32m+[0m[0m signing_profile_version_arn    = (known after apply)
      [32m+[0m[0m skip_destroy                   = false
      [32m+[0m[0m source_code_hash               = (known after apply)
      [32m+[0m[0m source_code_size               = (known after apply)
      [32m+[0m[0m tags_all                       = (known after apply)
      [32m+[0m[0m timeout                        = 600
      [32m+[0m[0m version                        = (known after apply)
    }

[1m  # aws_lambda_function.send-to-email-function-715[0m will be created
[0m  [32m+[0m[0m resource "aws_lambda_function" "send-to-email-function-715" {
      [32m+[0m[0m architectures                  = (known after apply)
      [32m+[0m[0m arn                            = (known after apply)
      [32m+[0m[0m code_sha256                    = (known after apply)
      [32m+[0m[0m function_name                  = "send-to-email-function-715"
      [32m+[0m[0m handler                        = "send_to_email.main.lambda_handler"
      [32m+[0m[0m id                             = (known after apply)
      [32m+[0m[0m invoke_arn                     = (known after apply)
      [32m+[0m[0m last_modified                  = (known after apply)
      [32m+[0m[0m memory_size                    = 500
      [32m+[0m[0m package_type                   = "Zip"
      [32m+[0m[0m publish                        = false
      [32m+[0m[0m qualified_arn                  = (known after apply)
      [32m+[0m[0m qualified_invoke_arn           = (known after apply)
      [32m+[0m[0m reserved_concurrent_executions = -1
      [32m+[0m[0m role                           = "arn:aws:iam::166366443471:role/transcribe-lambda-role"
      [32m+[0m[0m runtime                        = "python3.10"
      [32m+[0m[0m s3_bucket                      = "transcriber-deployment-package-bucket-715"
      [32m+[0m[0m s3_key                         = "lambda.zip"
      [32m+[0m[0m s3_object_version              = "Fby6.WXUrkl9No.N9VVbnpkq6WLG2q86"
      [32m+[0m[0m signing_job_arn                = (known after apply)
      [32m+[0m[0m signing_profile_version_arn    = (known after apply)
      [32m+[0m[0m skip_destroy                   = false
      [32m+[0m[0m source_code_hash               = (known after apply)
      [32m+[0m[0m source_code_size               = (known after apply)
      [32m+[0m[0m tags_all                       = (known after apply)
      [32m+[0m[0m timeout                        = 10
      [32m+[0m[0m version                        = (known after apply)
    }

[1m  # aws_lambda_function.transcribe-function-715[0m will be created
[0m  [32m+[0m[0m resource "aws_lambda_function" "transcribe-function-715" {
      [32m+[0m[0m architectures                  = (known after apply)
      [32m+[0m[0m arn                            = (known after apply)
      [32m+[0m[0m code_sha256                    = (known after apply)
      [32m+[0m[0m function_name                  = "transcribe-function-715"
      [32m+[0m[0m handler                        = "transcribe.main.lambda_handler"
      [32m+[0m[0m id                             = (known after apply)
      [32m+[0m[0m invoke_arn                     = (known after apply)
      [32m+[0m[0m last_modified                  = (known after apply)
      [32m+[0m[0m memory_size                    = 500
      [32m+[0m[0m package_type                   = "Zip"
      [32m+[0m[0m publish                        = false
      [32m+[0m[0m qualified_arn                  = (known after apply)
      [32m+[0m[0m qualified_invoke_arn           = (known after apply)
      [32m+[0m[0m reserved_concurrent_executions = -1
      [32m+[0m[0m role                           = "arn:aws:iam::166366443471:role/transcribe-lambda-role"
      [32m+[0m[0m runtime                        = "python3.10"
      [32m+[0m[0m s3_bucket                      = "transcriber-deployment-package-bucket-715"
      [32m+[0m[0m s3_key                         = "lambda.zip"
      [32m+[0m[0m s3_object_version              = "Fby6.WXUrkl9No.N9VVbnpkq6WLG2q86"
      [32m+[0m[0m signing_job_arn                = (known after apply)
      [32m+[0m[0m signing_profile_version_arn    = (known after apply)
      [32m+[0m[0m skip_destroy                   = false
      [32m+[0m[0m source_code_hash               = (known after apply)
      [32m+[0m[0m source_code_size               = (known after apply)
      [32m+[0m[0m tags_all                       = (known after apply)
      [32m+[0m[0m timeout                        = 10
      [32m+[0m[0m version                        = (known after apply)
    }

[1m  # aws_lambda_permission.allow_bucket-email[0m will be created
[0m  [32m+[0m[0m resource "aws_lambda_permission" "allow_bucket-email" {
      [32m+[0m[0m action              = "lambda:InvokeFunction"
      [32m+[0m[0m function_name       = "send-to-email-function-715"
      [32m+[0m[0m id                  = (known after apply)
      [32m+[0m[0m principal           = "s3.amazonaws.com"
      [32m+[0m[0m source_arn          = "arn:aws:s3:::audio-bucket-715"
      [32m+[0m[0m statement_id        = "AllowExecutionFromS3Bucket"
      [32m+[0m[0m statement_id_prefix = (known after apply)
    }

[1m  # aws_lambda_permission.allow_bucket-transcribe[0m will be created
[0m  [32m+[0m[0m resource "aws_lambda_permission" "allow_bucket-transcribe" {
      [32m+[0m[0m action              = "lambda:InvokeFunction"
      [32m+[0m[0m function_name       = "transcribe-function-715"
      [32m+[0m[0m id                  = (known after apply)
      [32m+[0m[0m principal           = "s3.amazonaws.com"
      [32m+[0m[0m source_arn          = "arn:aws:s3:::audio-bucket-715"
      [32m+[0m[0m statement_id        = "AllowExecutionFromS3Bucket"
      [32m+[0m[0m statement_id_prefix = (known after apply)
    }

[1m  # aws_lambda_permission.apigw[0m will be created
[0m  [32m+[0m[0m resource "aws_lambda_permission" "apigw" {
      [32m+[0m[0m action              = "lambda:InvokeFunction"
      [32m+[0m[0m function_name       = "download-audio-function-715"
      [32m+[0m[0m id                  = (known after apply)
      [32m+[0m[0m principal           = "apigateway.amazonaws.com"
      [32m+[0m[0m source_arn          = "arn:aws:execute-api:us-west-2:166366443471:x0pu13lwle/*/*"
      [32m+[0m[0m statement_id        = "AllowAPIGatewayInvoke"
      [32m+[0m[0m statement_id_prefix = (known after apply)
    }

[1m  # aws_s3_bucket_notification.audio_upload_notifications[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_notification" "audio_upload_notifications" {
      [32m+[0m[0m bucket      = "audio-bucket-715"
      [32m+[0m[0m eventbridge = false
      [32m+[0m[0m id          = (known after apply)

      [32m+[0m[0m lambda_function {
          [32m+[0m[0m events              = [
              [32m+[0m[0m "s3:ObjectCreated:*",
            ]
          [32m+[0m[0m filter_suffix       = ".mp3"
          [32m+[0m[0m id                  = (known after apply)
          [32m+[0m[0m lambda_function_arn = (known after apply)
        }
      [32m+[0m[0m lambda_function {
          [32m+[0m[0m events              = [
              [32m+[0m[0m "s3:ObjectCreated:*",
            ]
          [32m+[0m[0m filter_suffix       = ".srt"
          [32m+[0m[0m id                  = (known after apply)
          [32m+[0m[0m lambda_function_arn = (known after apply)
        }
    }

[1mPlan:[0m 11 to add, 0 to change, 0 to destroy.
[0m
Changes to Outputs:
  [32m+[0m[0m api_gateway_invoke_url = (known after apply)
[0m[1maws_lambda_function.transcribe-function-715: Creating...[0m[0m
[0m[1maws_lambda_function.send-to-email-function-715: Creating...[0m[0m
[0m[1maws_lambda_function.download-audio-function-715: Creating...[0m[0m
[0m[1maws_lambda_function.send-to-email-function-715: Creation complete after 5s [id=send-to-email-function-715][0m
[0m[1maws_lambda_permission.allow_bucket-email: Creating...[0m[0m
[0m[1maws_lambda_function.transcribe-function-715: Creation complete after 6s [id=transcribe-function-715][0m
[0m[1maws_lambda_permission.allow_bucket-transcribe: Creating...[0m[0m
[0m[1maws_lambda_permission.allow_bucket-email: Creation complete after 1s [id=AllowExecutionFromS3Bucket][0m
[0m[1maws_lambda_permission.allow_bucket-transcribe: Creation complete after 0s [id=AllowExecutionFromS3Bucket][0m
[0m[1maws_s3_bucket_notification.audio_upload_notifications: Creating...[0m[0m
[0m[1maws_lambda_function.download-audio-function-715: Creation complete after 6s [id=download-audio-function-715][0m
[0m[1maws_lambda_permission.apigw: Creating...[0m[0m
[0m[1maws_api_gateway_integration.transcriber-api-integration-post: Creating...[0m[0m
[0m[1maws_s3_bucket_notification.audio_upload_notifications: Creation complete after 0s [id=audio-bucket-715][0m
[0m[1maws_lambda_permission.apigw: Creation complete after 0s [id=AllowAPIGatewayInvoke][0m
[0m[1maws_api_gateway_integration.transcriber-api-integration-post: Creation complete after 0s [id=agi-x0pu13lwle-twufwu-POST][0m
[0m[1maws_api_gateway_deployment.transcriber_api_deployment: Creating...[0m[0m
[0m[1maws_api_gateway_integration_response.transcriber-api-integration-response-post: Creating...[0m[0m
[0m[1maws_api_gateway_integration_response.transcriber-api-integration-response-post: Creation complete after 0s [id=agir-x0pu13lwle-twufwu-POST-200][0m
[0m[1maws_api_gateway_deployment.transcriber_api_deployment: Creation complete after 1s [id=ou17jf][0m
[0m[1maws_api_gateway_stage.transcriber-api-dev: Creating...[0m[0m
[0m[1maws_api_gateway_stage.transcriber-api-dev: Creation complete after 0s [id=ags-x0pu13lwle-dev][0m
[0m[1m[32m
Apply complete! Resources: 11 added, 0 changed, 0 destroyed.
[0m[0m[1m[32m
Outputs:

[0mapi_gateway_invoke_url = "https://x0pu13lwle.execute-api.us-west-2.amazonaws.com/"
